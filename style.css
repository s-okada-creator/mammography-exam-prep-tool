/* マンモグラフィー検定テスト対策ツール - 大幅アップデート版 */
:root{--primary:#6366f1;--primary-dark:#4f46e5;--primary-light:#818cf8;--secondary:#10b981;--secondary-dark:#059669;--danger:#ef4444;--warning:#f59e0b;--success:#22c55e;--gray-50:#f9fafb;--gray-100:#f3f4f6;--gray-200:#e5e7eb;--gray-300:#d1d5db;--gray-400:#9ca3af;--gray-500:#6b7280;--gray-600:#4b5563;--gray-700:#374151;--gray-800:#1f2937;--gray-900:#111827;--white:#fff;--shadow-sm:0 1px 2px rgba(0,0,0,.05);--shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--shadow-lg:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--shadow-xl:0 20px 25px -5px rgba(0,0,0,.1),0 8px 10px -6px rgba(0,0,0,.1);--radius-sm:8px;--radius:12px;--radius-lg:16px;--radius-xl:24px;--transition:all .2s ease}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html{font-size:16px;-webkit-tap-highlight-color:transparent}
body{font-family:'Noto Sans JP','Hiragino Kaku Gothic ProN','Hiragino Sans','Meiryo',sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;color:var(--gray-800);line-height:1.7;-webkit-font-smoothing:antialiased}
.page{display:none;min-height:100vh}
.page.active{display:block}
.container{max-width:900px;margin:0 auto;padding:20px}
.top-header{text-align:center;padding:40px 20px;color:var(--white)}
.logo-area{display:flex;flex-direction:column;align-items:center;gap:16px}
.logo-icon{font-size:4rem;filter:drop-shadow(0 4px 8px rgba(0,0,0,.2))}
.top-header h1{font-size:1.8rem;font-weight:700;line-height:1.4;text-shadow:0 2px 4px rgba(0,0,0,.2)}
.top-header h1 span{font-weight:500}
.subtitle{font-size:1rem;opacity:.9;margin-top:12px}
.stats-panel{background:var(--white);border-radius:var(--radius-lg);padding:24px;margin-bottom:24px;box-shadow:var(--shadow-lg)}
.stats-panel h3{font-size:1rem;color:var(--gray-600);margin-bottom:16px;text-align:center}
.stats-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.stat-item{text-align:center;padding:12px 8px;background:var(--gray-50);border-radius:var(--radius-sm)}
.stat-value{display:block;font-size:1.5rem;font-weight:700;color:var(--primary)}
.stat-label{display:block;font-size:.75rem;color:var(--gray-500);margin-top:4px}
.mode-selection{display:flex;flex-direction:column;gap:16px}
.mode-card{display:flex;align-items:center;gap:20px;width:100%;padding:24px;background:var(--white);border:none;border-radius:var(--radius-lg);cursor:pointer;transition:var(--transition);box-shadow:var(--shadow);text-align:left}
.mode-card:hover{transform:translateY(-4px);box-shadow:var(--shadow-xl)}
.mode-card:active{transform:translateY(0)}
.mode-card .mode-icon{font-size:2.5rem;flex-shrink:0}
.mode-card .mode-content{flex:1}
.mode-card h2{font-size:1.25rem;font-weight:700;color:var(--gray-800);margin-bottom:4px}
.mode-card p{font-size:.875rem;color:var(--gray-500);margin-bottom:8px}
.mode-badge{display:inline-block;font-size:.75rem;font-weight:600;color:var(--primary);background:rgba(99,102,241,.1);padding:4px 12px;border-radius:100px}
.mode-card-review .mode-badge{color:var(--secondary);background:rgba(16,185,129,.1)}
.mode-arrow{font-size:1.5rem;color:var(--gray-400);transition:var(--transition)}
.mode-card:hover .mode-arrow{color:var(--primary);transform:translateX(4px)}
.top-footer{display:flex;justify-content:center;gap:16px;margin-top:32px}
.btn-text{background:transparent;border:none;color:rgba(255,255,255,.8);font-size:.875rem;cursor:pointer;padding:8px 16px;transition:var(--transition)}
.btn-text:hover{color:var(--white)}
.page-header{display:flex;align-items:center;gap:16px;margin-bottom:24px;color:var(--white)}
.page-header h1{font-size:1.5rem;font-weight:700}
.btn-back{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,.15);border:none;color:var(--white);padding:10px 16px;border-radius:var(--radius);font-size:.875rem;font-weight:500;cursor:pointer;transition:var(--transition)}
.btn-back:hover{background:rgba(255,255,255,.25)}
.setup-form{background:var(--white);border-radius:var(--radius-lg);padding:32px;box-shadow:var(--shadow-lg)}
.form-section{margin-bottom:32px}
.form-label{display:flex;justify-content:space-between;align-items:center;font-size:1rem;font-weight:600;color:var(--gray-700);margin-bottom:16px}
.question-count-selector{display:grid;grid-template-columns:repeat(5,1fr);gap:8px}
.count-option{display:flex;flex-direction:column;align-items:center;padding:16px 8px;background:var(--gray-50);border:2px solid var(--gray-200);border-radius:var(--radius);font-size:1rem;font-weight:600;color:var(--gray-700);cursor:pointer;transition:var(--transition)}
.count-option:hover{border-color:var(--primary-light);background:rgba(99,102,241,.05)}
.count-option.selected{border-color:var(--primary);background:rgba(99,102,241,.1);color:var(--primary)}
.count-time{font-size:.75rem;font-weight:400;color:var(--gray-500);margin-top:4px}
.count-option.selected .count-time{color:var(--primary)}
.category-checkboxes{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}
.category-checkbox-item{position:relative}
.category-checkbox-item input{position:absolute;opacity:0;width:100%;height:100%;cursor:pointer;z-index:1}
.category-label{display:flex;align-items:center;gap:12px;padding:16px;background:var(--gray-50);border:2px solid var(--gray-200);border-radius:var(--radius);cursor:pointer;transition:var(--transition)}
.category-checkbox-item input:checked+.category-label{border-color:var(--primary);background:rgba(99,102,241,.05)}
.category-checkbox-item:hover .category-label{border-color:var(--primary-light)}
.category-color{width:12px;height:12px;border-radius:50%;flex-shrink:0}
.category-name{flex:1;font-size:.875rem;font-weight:500;color:var(--gray-700)}
.category-check{width:24px;height:24px;border:2px solid var(--gray-300);border-radius:6px;display:flex;align-items:center;justify-content:center;transition:var(--transition);color:transparent;font-size:.875rem}
.category-checkbox-item input:checked+.category-label .category-check{background:var(--primary);border-color:var(--primary);color:var(--white)}
.btn-select-all{font-size:.75rem;color:var(--primary);background:transparent;border:none;cursor:pointer;padding:4px 8px}
.options-list{display:flex;flex-direction:column;gap:12px}
.option-item{display:flex;align-items:center;gap:12px;padding:16px;background:var(--gray-50);border-radius:var(--radius);cursor:pointer;transition:var(--transition)}
.option-item:hover{background:var(--gray-100)}
.option-item input{position:absolute;opacity:0}
.option-checkbox{width:24px;height:24px;border:2px solid var(--gray-300);border-radius:6px;display:flex;align-items:center;justify-content:center;transition:var(--transition);flex-shrink:0}
.option-checkbox::after{content:"✓";color:var(--white);font-size:.875rem;opacity:0;transition:var(--transition)}
.option-item input:checked+.option-checkbox{background:var(--primary);border-color:var(--primary)}
.option-item input:checked+.option-checkbox::after{opacity:1}
.option-text{font-size:.9375rem;color:var(--gray-700)}
.btn-primary{display:inline-flex;align-items:center;justify-content:center;gap:8px;background:var(--primary);color:var(--white);border:none;padding:14px 28px;border-radius:var(--radius);font-size:1rem;font-weight:600;cursor:pointer;transition:var(--transition);box-shadow:var(--shadow)}
.btn-primary:hover{background:var(--primary-dark);transform:translateY(-2px);box-shadow:var(--shadow-lg)}
.btn-primary:active{transform:translateY(0)}
.btn-secondary{display:inline-flex;align-items:center;justify-content:center;gap:8px;background:var(--gray-100);color:var(--gray-700);border:none;padding:14px 28px;border-radius:var(--radius);font-size:1rem;font-weight:600;cursor:pointer;transition:var(--transition)}
.btn-secondary:hover{background:var(--gray-200)}
.btn-outline{display:inline-flex;align-items:center;justify-content:center;gap:8px;background:transparent;color:var(--primary);border:2px solid var(--primary);padding:12px 26px;border-radius:var(--radius);font-size:1rem;font-weight:600;cursor:pointer;transition:var(--transition)}
.btn-outline:hover{background:var(--primary);color:var(--white)}
.btn-large{width:100%;padding:18px 32px;font-size:1.125rem}
.btn-icon{font-size:1.25rem}
.btn-icon-only{width:44px;height:44px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,.1);border:none;border-radius:var(--radius);color:var(--white);font-size:1.25rem;cursor:pointer;transition:var(--transition)}
.btn-icon-only:hover{background:rgba(255,255,255,.2)}
.test-container{display:flex;flex-direction:column;min-height:100vh;padding:0}
.test-header{position:sticky;top:0;z-index:100;display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:rgba(255,255,255,.95);backdrop-filter:blur(8px);box-shadow:var(--shadow)}
.test-header-left{display:flex;align-items:center;gap:12px}
.test-mode-badge{font-size:.75rem;font-weight:600;color:var(--primary);background:rgba(99,102,241,.1);padding:4px 12px;border-radius:100px}
.test-header-center{flex:1;max-width:300px;margin:0 16px}
.progress-bar-container{height:8px;background:var(--gray-200);border-radius:100px;overflow:hidden;margin-bottom:4px}
.progress-bar{height:100%;background:linear-gradient(90deg,var(--primary),var(--primary-light));border-radius:100px;transition:width .3s ease}
.progress-text{font-size:.75rem;color:var(--gray-500);text-align:center;display:block}
.test-header-right{display:flex;align-items:center}
.timer{font-size:1rem;font-weight:600;color:var(--gray-700);font-variant-numeric:tabular-nums}
.question-nav-wrapper{background:var(--white);border-bottom:1px solid var(--gray-200)}
.question-nav-toggle{display:flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:12px;background:transparent;border:none;color:var(--gray-600);font-size:.875rem;cursor:pointer}
.toggle-icon{transition:transform .3s ease}
.toggle-icon.rotated{transform:rotate(180deg)}
.question-navigation{display:flex;flex-wrap:wrap;gap:8px;padding:0 16px 16px;max-height:200px;overflow-y:auto;transition:max-height .3s ease,padding .3s ease}
.question-navigation.collapsed{max-height:0;padding-top:0;padding-bottom:0;overflow:hidden}
.question-nav-item{width:44px;height:44px;border:2px solid var(--gray-200);border-radius:var(--radius-sm);background:var(--white);color:var(--gray-600);font-size:.875rem;font-weight:600;cursor:pointer;transition:var(--transition);display:flex;align-items:center;justify-content:center}
.question-nav-item:hover{border-color:var(--primary);color:var(--primary)}
.question-nav-item.current{background:var(--primary);border-color:var(--primary);color:var(--white)}
.question-nav-item.answered{background:var(--secondary);border-color:var(--secondary);color:var(--white)}
.question-nav-item.answered.current{background:var(--primary);border-color:var(--primary)}
.question-area{flex:1;padding:20px;overflow-y:auto}
.question-card{background:var(--white);border-radius:var(--radius-lg);padding:24px;box-shadow:var(--shadow)}
.question-meta{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:20px}
.question-number-badge{font-size:.875rem;font-weight:700;color:var(--primary);background:rgba(99,102,241,.1);padding:6px 14px;border-radius:100px}
.question-category-badge{font-size:.75rem;font-weight:600;color:var(--white);padding:6px 14px;border-radius:100px}
.question-type-badge{font-size:.75rem;font-weight:500;color:var(--gray-600);background:var(--gray-100);padding:6px 14px;border-radius:100px}
.question-text{font-size:1.125rem;font-weight:500;line-height:1.8;color:var(--gray-800);margin-bottom:24px}
.question-image{margin-bottom:24px;text-align:center}
.question-image img{max-width:100%;border-radius:var(--radius);box-shadow:var(--shadow)}
.choices-container{display:flex;flex-direction:column;gap:12px}
.choice-item{position:relative;display:flex;align-items:flex-start;gap:16px;padding:20px;background:var(--gray-50);border:2px solid var(--gray-200);border-radius:var(--radius);cursor:pointer;transition:var(--transition);min-height:64px;-webkit-tap-highlight-color:transparent}
.choice-item:hover{border-color:var(--primary-light);background:rgba(99,102,241,.05)}
.choice-item.selected{border-color:var(--primary);background:rgba(99,102,241,.1)}
.choice-item.correct{border-color:var(--success);background:rgba(34,197,94,.1)}
.choice-item.incorrect{border-color:var(--danger);background:rgba(239,68,68,.1)}
.choice-item input{position:absolute;opacity:0;width:100%;height:100%;left:0;top:0;cursor:pointer;z-index:1}
.choice-radio,.choice-checkbox{width:28px;height:28px;border:2px solid var(--gray-300);border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:var(--transition);background:var(--white)}
.choice-checkbox{border-radius:6px}
.choice-item.selected .choice-radio,.choice-item.selected .choice-checkbox{border-color:var(--primary);background:var(--primary)}
.choice-item.selected .choice-radio::after{content:"";width:10px;height:10px;background:var(--white);border-radius:50%}
.choice-item.selected .choice-checkbox::after{content:"✓";color:var(--white);font-size:.875rem;font-weight:700}
.choice-item.correct .choice-radio,.choice-item.correct .choice-checkbox{border-color:var(--success);background:var(--success)}
.choice-item.incorrect .choice-radio,.choice-item.incorrect .choice-checkbox{border-color:var(--danger);background:var(--danger)}
.choice-label-wrapper{flex:1;display:flex;align-items:flex-start;gap:8px}
.choice-letter{font-size:1rem;font-weight:700;color:var(--gray-500);min-width:24px}
.choice-item.selected .choice-letter{color:var(--primary)}
.choice-text{font-size:1rem;color:var(--gray-700);line-height:1.6}
.instant-feedback{margin-top:24px;padding:20px;border-radius:var(--radius);animation:slideIn .3s ease}
@keyframes slideIn{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}
.instant-feedback.correct{background:rgba(34,197,94,.1);border:2px solid var(--success)}
.instant-feedback.incorrect{background:rgba(239,68,68,.1);border:2px solid var(--danger)}
.feedback-result{font-size:1.25rem;font-weight:700;margin-bottom:12px}
.instant-feedback.correct .feedback-result{color:var(--success)}
.instant-feedback.incorrect .feedback-result{color:var(--danger)}
.feedback-explanation{font-size:.9375rem;color:var(--gray-700);line-height:1.7}
.question-footer{position:sticky;bottom:0;display:flex;gap:12px;padding:16px 20px;background:rgba(255,255,255,.95);backdrop-filter:blur(8px);box-shadow:0 -4px 6px rgba(0,0,0,.05)}
.btn-nav{flex:1;display:flex;align-items:center;justify-content:center;gap:8px;padding:16px 20px;background:var(--gray-100);border:none;border-radius:var(--radius);font-size:1rem;font-weight:600;color:var(--gray-700);cursor:pointer;transition:var(--transition)}
.btn-nav:hover{background:var(--gray-200)}
.btn-nav:disabled{opacity:.4;cursor:not-allowed}
.btn-next{background:var(--primary);color:var(--white)}
.btn-next:hover{background:var(--primary-dark)}
.btn-submit{flex:1;padding:16px 20px;background:var(--secondary);border:none;border-radius:var(--radius);font-size:1rem;font-weight:600;color:var(--white);cursor:pointer;transition:var(--transition)}
.btn-submit:hover{background:var(--secondary-dark)}
.btn-nav-icon{font-size:1.25rem}
.result-header{display:flex;flex-direction:column;align-items:center;text-align:center;padding:40px 20px;color:var(--white)}
.result-score-circle{position:relative;width:180px;height:180px;margin-bottom:24px}
.result-score-circle svg{transform:rotate(-90deg);width:100%;height:100%}
.score-circle-bg{fill:none;stroke:rgba(255,255,255,.2);stroke-width:8}
.score-circle-progress{fill:none;stroke:var(--white);stroke-width:8;stroke-linecap:round;stroke-dasharray:283;stroke-dashoffset:283;transition:stroke-dashoffset 1s ease}
.score-text{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;align-items:baseline}
.score-percentage{font-size:3rem;font-weight:700}
.score-unit{font-size:1.5rem;font-weight:500;margin-left:2px}
.result-summary-text h1{font-size:1.5rem;font-weight:700;margin-bottom:8px}
.result-summary-text p{font-size:1rem;opacity:.9}
.result-time{font-size:.875rem;opacity:.8;margin-top:8px}
.result-section{background:var(--white);border-radius:var(--radius-lg);padding:24px;margin-bottom:20px;box-shadow:var(--shadow)}
.result-section h2{font-size:1.125rem;font-weight:700;color:var(--gray-800);margin-bottom:20px}
.category-scores{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}
.category-score-item{padding:16px;background:var(--gray-50);border-radius:var(--radius);border-left:4px solid var(--primary)}
.category-score-item h3{font-size:.875rem;font-weight:600;color:var(--gray-700);margin-bottom:8px}
.category-score-bar{height:8px;background:var(--gray-200);border-radius:100px;overflow:hidden;margin-bottom:8px}
.category-score-fill{height:100%;border-radius:100px;transition:width .5s ease}
.category-score-text{display:flex;justify-content:space-between;font-size:.875rem;color:var(--gray-600)}
.result-filter{display:flex;gap:8px;margin-bottom:16px;overflow-x:auto;padding-bottom:4px}
.filter-btn{padding:8px 16px;background:var(--gray-100);border:none;border-radius:100px;font-size:.875rem;font-weight:500;color:var(--gray-600);cursor:pointer;transition:var(--transition);white-space:nowrap}
.filter-btn:hover{background:var(--gray-200)}
.filter-btn.active{background:var(--primary);color:var(--white)}
.question-results{display:flex;flex-direction:column;gap:12px}
.question-result-item{padding:20px;border-radius:var(--radius);border-left:4px solid}
.question-result-item.correct{background:rgba(34,197,94,.05);border-color:var(--success)}
.question-result-item.incorrect{background:rgba(239,68,68,.05);border-color:var(--danger)}
.question-result-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
.question-result-number{font-weight:600;color:var(--gray-700)}
.question-result-mark{font-size:1.5rem;font-weight:700}
.question-result-item.correct .question-result-mark{color:var(--success)}
.question-result-item.incorrect .question-result-mark{color:var(--danger)}
.question-result-text{font-size:.9375rem;color:var(--gray-700);margin-bottom:12px;line-height:1.7}
.question-result-answer{font-size:.875rem;padding:12px;background:rgba(255,255,255,.7);border-radius:var(--radius-sm);margin-bottom:12px}
.answer-label{font-weight:600;color:var(--gray-600);margin-right:8px}
.your-answer{color:var(--gray-800)}
.correct-answer{color:var(--success);font-weight:600}
.question-result-explanation{font-size:.875rem;color:var(--gray-600);padding:12px;background:var(--gray-50);border-radius:var(--radius-sm);border-left:3px solid var(--primary);line-height:1.7}
.result-actions{display:flex;flex-direction:column;gap:12px;padding:20px}
.modal{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);z-index:1000;align-items:center;justify-content:center;padding:20px}
.modal.active{display:flex}
.modal-content{background:var(--white);border-radius:var(--radius-lg);width:100%;max-width:600px;max-height:80vh;overflow:hidden;display:flex;flex-direction:column;animation:modalIn .3s ease}
@keyframes modalIn{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
.modal-small{max-width:400px}
.modal-header{display:flex;justify-content:space-between;align-items:center;padding:20px 24px;border-bottom:1px solid var(--gray-200)}
.modal-header h2{font-size:1.25rem;font-weight:700;color:var(--gray-800)}
.modal-close{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:var(--gray-100);border:none;border-radius:var(--radius-sm);font-size:1.25rem;color:var(--gray-600);cursor:pointer;transition:var(--transition)}
.modal-close:hover{background:var(--gray-200)}
.modal-body{padding:24px;overflow-y:auto;flex:1}
.modal-footer{display:flex;gap:12px;padding:16px 24px;border-top:1px solid var(--gray-200);justify-content:flex-end}
.history-list{display:flex;flex-direction:column;gap:12px}
.history-item{padding:16px;background:var(--gray-50);border-radius:var(--radius);border-left:4px solid var(--primary)}
.history-date{font-size:.75rem;color:var(--gray-500);margin-bottom:8px}
.history-score{font-size:1.25rem;font-weight:700;color:var(--primary);margin-bottom:4px}
.history-details{font-size:.875rem;color:var(--gray-600)}
.history-empty{text-align:center;padding:40px 20px;color:var(--gray-500)}
@media(max-width:768px){.stats-grid{grid-template-columns:repeat(2,1fr)}.question-count-selector{grid-template-columns:repeat(3,1fr)}.category-checkboxes{grid-template-columns:1fr}.test-header-center{display:none}.result-actions{flex-direction:column}}
@media(max-width:480px){html{font-size:14px}.container{padding:16px}.top-header{padding:24px 16px}.logo-icon{font-size:3rem}.top-header h1{font-size:1.5rem}.mode-card{padding:16px;gap:16px}.mode-card .mode-icon{font-size:2rem}.setup-form{padding:20px}.question-count-selector{grid-template-columns:repeat(2,1fr)}.question-card{padding:16px}.choice-item{padding:16px}.question-footer{padding:12px 16px}.btn-nav{padding:14px 16px}.btn-nav-text{display:none}.result-score-circle{width:140px;height:140px}.score-percentage{font-size:2.5rem}}
@media print{body{background:#fff}.page{display:block!important}.btn-back,.btn-primary,.btn-secondary,.btn-outline,.result-actions{display:none!important}}
